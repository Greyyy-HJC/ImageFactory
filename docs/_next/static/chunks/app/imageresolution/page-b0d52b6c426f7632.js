(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[973],{9199:function(e,t,a){Promise.resolve().then(a.bind(a,2588))},2588:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var l=a(3827),s=a(4090);let r=["image/png","image/jpeg","image/jpg","image/webp"],n="rounded-3xl border border-white/60 bg-white/80 p-8 shadow-[0_28px_60px_-30px_rgba(30,41,59,0.45)] backdrop-blur-xl",i="w-full rounded-2xl border border-slate-200 bg-white/70 px-4 py-3 text-sm text-slate-900 placeholder:text-slate-400 shadow-inner focus:border-[#007AFF] focus:outline-none focus:ring-2 focus:ring-[#007AFF]/40",c="inline-flex items-center justify-center rounded-full bg-[#007AFF] px-6 py-3 text-base font-semibold text-white shadow-[0_24px_40px_-20px_rgba(0,122,255,0.65)] transition hover:bg-[#0066d6] active:bg-[#0054ad] focus:outline-none focus:ring-4 focus:ring-[#007AFF]/40 disabled:cursor-not-allowed disabled:bg-[#9CC8FF] disabled:shadow-none";function o(e){return Math.max(0,Math.min(255,e))}function d(){let[e,t]=(0,s.useState)(null),[a,d]=(0,s.useState)(.4),[u,h]=(0,s.useState)(1),[x,m]=(0,s.useState)("image/png"),[g,p]=(0,s.useState)(.92),[b,f]=(0,s.useState)(null),[j,v]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null);(0,s.useEffect)(()=>()=>{e&&URL.revokeObjectURL(e.previewUrl),b&&URL.revokeObjectURL(b)},[e,b]);let y=(0,s.useCallback)(async a=>{if(!a||0===a.length)return;let l=a[0];if(!r.includes(l.type)){N("请上传 PNG、JPG 或 WebP 图片。");return}let s=await (async()=>{let e=URL.createObjectURL(l);try{let t=await new Promise((t,a)=>{let l=new Image;l.onload=()=>t(l),l.onerror=a,l.src=e});return{width:t.naturalWidth,height:t.naturalHeight}}finally{URL.revokeObjectURL(e)}})();e&&URL.revokeObjectURL(e.previewUrl),b&&URL.revokeObjectURL(b),t({file:l,previewUrl:URL.createObjectURL(l),width:s.width,height:s.height}),f(null),N(null)},[e,b]),F=(0,s.useCallback)(async()=>{if(!e){N("请先上传图片。");return}v(!0),N(null);try{let t=await createImageBitmap(e.file),l=Math.round(e.width*u),s=Math.round(e.height*u),r=document.createElement("canvas");r.width=l,r.height=s;let n=r.getContext("2d");if(!n)throw Error("未能创建绘图上下文");if(n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.drawImage(t,0,0,l,s),a>0){let e=n.getImageData(0,0,l,s),t=function(e,t){if(t<=0)return e;let{data:a,width:l,height:s}=e,r=new Uint8ClampedArray(a.length),n=[0,-1,0,-1,5,-1,0,-1,0],i=Math.floor(1.5);for(let e=0;e<s;e+=1)for(let c=0;c<l;c+=1){let d=(e*l+c)*4,u=a[d],h=a[d+1],x=a[d+2],m=a[d+3],g=0,p=0,b=0;for(let t=-i;t<=i;t+=1)for(let r=-i;r<=i;r+=1){let o=Math.min(l-1,Math.max(0,c+r)),d=(Math.min(s-1,Math.max(0,e+t))*l+o)*4,u=n[(t+i)*3+(r+i)];g+=a[d]*u,p+=a[d+1]*u,b+=a[d+2]*u}r[d]=o(u*(1-t)+g*t),r[d+1]=o(h*(1-t)+p*t),r[d+2]=o(x*(1-t)+b*t),r[d+3]=m}return new ImageData(r,l,s)}(e,a);n.putImageData(t,0,0)}let i=r.toDataURL(x,"image/png"===x?void 0:g);b&&URL.revokeObjectURL(b),f(i)}catch(e){console.error(e),N("处理图片时出现问题，请稍后重试。")}finally{v(!1)}},[e,g,x,b,a,u]),U=(0,s.useCallback)(()=>{e&&URL.revokeObjectURL(e.previewUrl),b&&URL.revokeObjectURL(b),t(null),f(null),N(null)},[e,b]),L=(0,s.useMemo)(()=>{if(!e)return null;let t=Math.round(e.width*u),a=Math.round(e.height*u);return 1===u?"原始尺寸：".concat(e.width," \xd7 ").concat(e.height," px"):"输出尺寸：".concat(t," \xd7 ").concat(a," px（基于 ").concat(e.width," \xd7 ").concat(e.height,"）")},[e,u]);return(0,l.jsxs)("section",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"".concat(n," space-y-6"),children:[(0,l.jsx)("div",{className:"space-y-2",children:(0,l.jsxs)("label",{onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),y(e.dataTransfer.files)},className:"flex cursor-pointer flex-col items-center justify-center gap-3 rounded-2xl border border-dashed border-slate-300 bg-white/60 px-6 py-10 text-center transition hover:border-[#007AFF]/40 hover:bg-[#F3F6FF]",children:[(0,l.jsx)("span",{className:"rounded-full bg-[#007AFF]/10 px-4 py-1 text-xs font-medium text-[#0A84FF]",children:"拖拽或点击上传"}),(0,l.jsx)("p",{className:"text-lg font-medium text-slate-700",children:"选择待增强的图片"}),(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"支持 PNG / JPG / WebP，保持原尺寸或进行超分辨率。"}),(0,l.jsx)("input",{type:"file",accept:r.join(","),className:"hidden",onChange:e=>y(e.target.files)})]})}),e&&(0,l.jsxs)("div",{className:"".concat("rounded-2xl border border-white/70 bg-white/60 p-4 backdrop-blur"," grid gap-4 md:grid-cols-2"),children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-semibold text-slate-700",children:["锐化程度 (",Math.round(100*a),"%)"]}),(0,l.jsx)("input",{type:"range",min:0,max:1,step:.05,value:a,onChange:e=>d(Number(e.target.value)),className:"w-full accent-[#007AFF]"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"提升边缘对比度，增强细节，避免过高以防噪点。"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"超分辨率"}),(0,l.jsxs)("select",{className:i,value:u,onChange:e=>h(Number(e.target.value)),children:[(0,l.jsx)("option",{value:1,children:"保持原尺寸 (1\xd7)"}),(0,l.jsx)("option",{value:1.5,children:"增强 1.5\xd7"}),(0,l.jsx)("option",{value:2,children:"增强 2\xd7"})]}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"简单的插值放大搭配锐化，可用于社交媒体分享或打印。"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"输出格式"}),(0,l.jsxs)("select",{className:i,value:x,onChange:e=>m(e.target.value),children:[(0,l.jsx)("option",{value:"image/png",children:"PNG（无损）"}),(0,l.jsx)("option",{value:"image/jpeg",children:"JPG（可调质量）"})]})]}),"image/jpeg"===x&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-sm font-semibold text-slate-700",children:["JPG 质量 (",Math.round(100*g),"%)"]}),(0,l.jsx)("input",{type:"range",min:.5,max:1,step:.05,value:g,onChange:e=>p(Number(e.target.value)),className:"w-full accent-[#007AFF]"})]})]}),L&&(0,l.jsx)("div",{className:"rounded-2xl border border-white/70 bg-white/70 p-4 text-xs text-slate-500",children:L}),w&&(0,l.jsx)("div",{className:"rounded-2xl border border-red-200/70 bg-red-50/80 px-4 py-3 text-sm text-red-700",children:w}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-end gap-3",children:[(0,l.jsx)("button",{type:"button",className:"inline-flex items-center justify-center rounded-full border border-slate-200/80 bg-white/70 px-5 py-3 text-sm font-medium text-slate-600 transition hover:border-[#007AFF]/60 hover:text-[#007AFF] focus:outline-none focus:ring-4 focus:ring-[#007AFF]/30 disabled:opacity-60",onClick:U,disabled:j,children:"清空"}),(0,l.jsx)("button",{type:"button",className:c,onClick:F,disabled:j||!e,children:j?"处理中…":"生成增强图片"})]})]}),e&&(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsxs)("div",{className:n,children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"原图预览"}),(0,l.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-white/60 bg-white/70 p-4",children:(0,l.jsx)("img",{src:e.previewUrl,alt:"原图预览",className:"w-full"})})]}),b&&(0,l.jsxs)("div",{className:n,children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"增强后预览"}),(0,l.jsx)("a",{href:b,download:"image-enhanced.".concat("image/png"===x?"png":"jpg"),className:c,children:"下载图片"})]}),(0,l.jsx)("p",{className:"mt-2 text-sm text-slate-500",children:"下载结果可用于打印或高清展示，若出现噪点可适当降低锐化程度。"}),(0,l.jsx)("div",{className:"mt-4 overflow-hidden rounded-2xl border border-white/60 bg-white/70 p-4",children:(0,l.jsx)("img",{src:b,alt:"增强图预览",className:"w-full"})})]})]})]})}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=9199)}),_N_E=e.O()}]);